<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Troubleshooting · Hurst.jl</title><meta name="title" content="Troubleshooting · Hurst.jl"/><meta property="og:title" content="Troubleshooting · Hurst.jl"/><meta property="twitter:title" content="Troubleshooting · Hurst.jl"/><meta name="description" content="Documentation for Hurst.jl."/><meta property="og:description" content="Documentation for Hurst.jl."/><meta property="twitter:description" content="Documentation for Hurst.jl."/><meta property="og:url" content="https://josephcbradley.github.io/Hurst.jl/troubleshooting/"/><meta property="twitter:url" content="https://josephcbradley.github.io/Hurst.jl/troubleshooting/"/><link rel="canonical" href="https://josephcbradley.github.io/Hurst.jl/troubleshooting/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Hurst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Hurst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Troubleshooting</a><ul class="internal"><li><a class="tocitem" href="#TL;DR:"><span>TL;DR:</span></a></li><li><a class="tocitem" href="#Why-am-I-getting-weird-results-for-H?"><span>Why am I getting weird results for <span>$H$</span>?</span></a></li><li><a class="tocitem" href="#Verify-that-the-quantity-is-scaling"><span>Verify that the quantity is scaling</span></a></li></ul></li><li><a class="tocitem" href="../ref/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Troubleshooting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Troubleshooting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/josephcbradley/Hurst.jl/blob/main/docs/src/troubleshooting.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Troubleshooting"><a class="docs-heading-anchor" href="#Troubleshooting">Troubleshooting</a><a id="Troubleshooting-1"></a><a class="docs-heading-anchor-permalink" href="#Troubleshooting" title="Permalink"></a></h1><p>The most likely problem to encounter when using this package is <code>NaN</code> outputs from <code>hurst_exponent(...)</code>. This normally happens when the data you have provided is not self-similar in the way the package expects. Before filing an issue on Github, please read the advice below. </p><h2 id="TL;DR:"><a class="docs-heading-anchor" href="#TL;DR:">TL;DR:</a><a id="TL;DR:-1"></a><a class="docs-heading-anchor-permalink" href="#TL;DR:" title="Permalink"></a></h2><p>Do the following with your data <code>X</code>:</p><ol><li>Calculate <code>τ_range = 30:250; Q = [Hurst.qth_abs_moment(X, τ, 1) for τ in τ_range]</code></li><li>Check <code>plot(log.(τ_range), log.(Q))</code></li></ol><p>If the plot isn&#39;t roughly linear, you have a problem and you will not get good estimates for <span>$H$</span>.</p><h2 id="Why-am-I-getting-weird-results-for-H?"><a class="docs-heading-anchor" href="#Why-am-I-getting-weird-results-for-H?">Why am I getting weird results for <span>$H$</span>?</a><a id="Why-am-I-getting-weird-results-for-H?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-am-I-getting-weird-results-for-H?" title="Permalink"></a></h2><p>The easiest way to demonstrate what is probably going wrong is with Gaussian data, so we will generate some Gaussian increments (<span>$X(t) \sim \mathcal{N}(0, 1)$</span>) and a Gaussian walk (<span>$Z(t) = \sum_\tau X(\tau), X(\tau) \sim \mathcal{N}(0, 1)$</span>).</p><pre><code class="language-julia hljs">using Random
Random.seed!(123)
using Plots
gaussian_increments = randn(3000)
gaussian_walk = cumsum(gaussian_increments)
plot(
    (
        plot(gaussian_increments, label = &quot;Gaussian increments&quot;),
        plot(gaussian_walk, label = &quot;Gaussian walk&quot;)
    )..., layout = (2, 1)
)</code></pre><img src="3962bddd.svg" alt="Example block output"/><h2 id="Verify-that-the-quantity-is-scaling"><a class="docs-heading-anchor" href="#Verify-that-the-quantity-is-scaling">Verify that the quantity is scaling</a><a id="Verify-that-the-quantity-is-scaling-1"></a><a class="docs-heading-anchor-permalink" href="#Verify-that-the-quantity-is-scaling" title="Permalink"></a></h2><p><code>Hurst.jl</code> assumes your data <span>$X$</span> is self-similar, by which I mean:</p><p class="math-container">\[\left\{X\left(c t_1\right), \ldots, X\left(c t_k\right)\right\} \stackrel{\mathrm{d}}{=}\left\{c^H X\left(t_1\right), \ldots, c^H X\left(t_k\right)\right\}\]</p><p>for some <span>$H &gt; 0$</span> and a process <span>$X(t)$</span>. This definition is probably only intuitive to people already familiar with the subject, so one way to visualise this as follows:</p><ol><li>Define a time range, <code>t_range</code>, a scale <code>c</code> - let&#39;s say <code>0.5</code> - and a scaling exponent <code>H</code> (also <code>0.5</code>).</li><li>Plot the distribution of <code>X[c .* t_range]</code>, i.e. generate lots of <code>t_range</code> and plot <code>X[c .* t_range]</code> each time.</li><li>Similarly plot the distribution of <code>c^H .* X[t_range]</code></li><li>Compare the distributions.</li></ol><pre><code class="language-julia hljs">using Hurst

c = 0.1
H = 0.5
ntrials = 200
alpha = 0.2
starting_t = rand(100:200)
t_range = collect(range(starting_t, length = 20, step = 50))
scaled_t_range = round.(Int64, c .* t_range)
lhs_plt = plot(gaussian_walk[scaled_t_range], label = &quot;ctₖ&quot;, color = :blue, alpha = alpha)
rhs_plt = plot(c^H .* gaussian_walk[t_range], label = &quot;c^H&quot;, color = :blue, alpha = alpha)
for n = 1:ntrials - 1
    starting_t = rand(100:500)
    t_range .= collect(range(starting_t, length = 20, step = 100))
    scaled_t_range .= round.(Int64, c .* t_range)
    plot!(lhs_plt, gaussian_walk[scaled_t_range], label = nothing, color = :blue, alpha = alpha)
    plot!(rhs_plt, c^H .* gaussian_walk[t_range], label = nothing, color = :blue, alpha = alpha)
end
plot((lhs_plt, rhs_plt)..., layout = (2, 1))</code></pre><img src="0e47f6ed.svg" alt="Example block output"/><p>These plots are not perfectly similar - we&#39;re only using 200 samples in this case - but hopefully this scaling property is clear enough. When we scale time by <span>$c$</span>, if we scale our output by <span>$c^H$</span> we obtain a process that is statistically similar.</p><p>Now let&#39;s try with something that does not have this nice scaling property, e.g. <span>$\sin(x_i)$</span> for <code>i = 1:3000</code>:</p><pre><code class="language-julia hljs">X = sin.(1:3000)
starting_t = rand(100:500)
t_range = collect(range(starting_t, length = 20, step = 100))
scaled_t_range = round.(Int64, c .* t_range)
lhs_plt = plot(X[scaled_t_range], label = &quot;ctₖ&quot;, color = :blue, alpha = alpha)
rhs_plt = plot(c^H .* X[t_range], label = &quot;c^H&quot;, color = :blue, alpha = alpha)
for n = 1:ntrials - 1
    starting_t = rand(100:500)
    t_range .= collect(range(starting_t, length = 20, step = 100))
    scaled_t_range .= round.(Int64, c .* t_range)
    plot!(lhs_plt, X[scaled_t_range], label = nothing, color = :blue, alpha = alpha)
    plot!(rhs_plt, c^H* X[t_range], label = nothing, color = :blue, alpha = alpha)
end
plot((lhs_plt, rhs_plt)..., layout = (2, 1))</code></pre><img src="88dcec95.svg" alt="Example block output"/><p>Now the distributions look very different! If we try to calculate the Hurst exponent of <span>$\sin(x)$</span> we will get very strange results. Under the hood, <code>Hurst.jl</code> considers the moment of the absolute <span>$\tau$</span>-increments of the time series. Call this <span>$Q$</span>:</p><p class="math-container">\[Q = E\left[|X(t+\tau)-X(t)|\right]\]</p><p>where <span>$\tau$</span> represents some time delay. We assume that it is equal to a power law in <span>$\tau$</span>:</p><p class="math-container">\[Q=K\tau^{H}\]</p><p>We calculate the LHS for various values of <span>$\tau$</span> and take logs:</p><p class="math-container">\[\ln (Q) = H \ln (\tau)+\ln (K)\]</p><p>Our Hurst exponent <span>$H$</span> is just the coefficient of this linear regression. We can do this all using the functions in <code>Hurst.jl</code>:</p><pre><code class="language-julia hljs">τ_range = 1:19 #not the best choice but good for visualising
qth_moment_over_tau = [Hurst.qth_abs_moment(gaussian_walk, τ, 1) for τ ∈ τ_range]
scatter(log.(τ_range), log.(qth_moment_over_tau), title = &quot;Gaussian walk&quot;,
    xlabel = &quot;ln(τ)&quot;, label = &quot;ln qth absolute moment&quot;)
using GLM
gaussian_lm = lm(hcat(ones(length(τ_range)), log.(τ_range)), log.(qth_moment_over_tau))
a, b = coef(gaussian_lm)
plot!(lnτ -&gt; a + b*lnτ, log.(τ_range), label = &quot;Linear fit&quot;)</code></pre><img src="375984a6.svg" alt="Example block output"/><p>It is easy to see that a lienar regression on this will be meaningful and will give a good estimate for <span>$H$</span>. </p><p>However, if we do not have self-similar data, this linear relationship between <span>$\ln (\tau)$</span> and <span>$\ln (Q)$</span> will not be present, and we will get invalid values for <span>$H$</span>:</p><pre><code class="language-julia hljs">qth_moment_over_tau = [Hurst.qth_abs_moment(gaussian_increments, τ, 1) for τ ∈ τ_range]
scatter(log.(τ_range), log.(qth_moment_over_tau), title = &quot;sin(x)&quot;,
    xlabel = &quot;ln(τ)&quot;, label = &quot;ln qth absolute moment&quot;);
increments_lm = lm(hcat(ones(length(τ_range)), log.(τ_range)), log.(qth_moment_over_tau))
lnK, H = coef(increments_lm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
  0.11600417621795533
 -0.002042476985942567</code></pre><pre><code class="language-julia hljs">plot!(lnτ -&gt; lnK + H*lnτ, log.(τ_range), label = &quot;Linear fit&quot;)</code></pre><img src="28e79d8b.svg" alt="Example block output"/><p>A negative Hurst exponent is not possible, and only appears when we try to estimate one for data that is not scaling. If you try to calculate the Hurst exponent on data like this, <code>Hurst.jl</code> will return <code>NaN</code>:</p><pre><code class="language-julia hljs">H, SD = hurst_exponent(gaussian_increments, τ_range)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×2 Matrix{Float64}:
 -0.00204248  0.00211821</code></pre><p>At this point, hopefully you understand the motivation for the routine at the start of this page:</p><ol><li>Calculate <code>Q = [Hurst.qth_abs_moment(X, τ, q) for τ in τ_range]</code></li><li>Check <code>plot(log.(τ_range), log.(Q))</code></li></ol><p>If the plot isn&#39;t roughly linear, you have a problem and you will not get good estimates for <span>$H$</span>.</p><pre><code class="language-julia hljs">q = 1.
Q = [Hurst.qth_abs_moment(gaussian_increments, τ, q) for τ in τ_range]
plt = scatter(log.(τ_range), log.(Q), label = &quot;data&quot;)
nasty_lm = lm(hcat(ones(length(τ_range)), log.(τ_range)), log.(Q))
a, b = coef(nasty_lm)
plot!(plt, lnτ -&gt; a + b*lnτ, log.(τ_range), label = &quot;Linear fit&quot;)
plt
#not linear!</code></pre><img src="0ff043f5.svg" alt="Example block output"/><pre><code class="language-julia hljs">Q = [Hurst.qth_abs_moment(gaussian_walk, τ, q) for τ in τ_range]
plt = scatter(log.(τ_range), log.(Q), label = &quot;data&quot;)
nice_lm = lm(hcat(ones(length(τ_range)), log.(τ_range)), log.(Q))
a, b = coef(nice_lm)
plot!(plt, lnτ -&gt; a + b*lnτ, log.(τ_range), label = &quot;Linear fit&quot;)
plt
#much better</code></pre><img src="23809d1e.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../ref/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 4 January 2026 13:55">Sunday 4 January 2026</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
